<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.jsdelivr.net/combine/npm/vue@2/dist/vue.min.js,npm/iview@3/dist/iview.min.js,npm/typeson@5/dist/typeson.min.js,npm/typeson-registry@1.0.0-alpha.21/dist/all.min.js,npm/vue-clipboard2@0.2/dist/vue-clipboard.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div id="app">
    <dropdown trigger="click" v-on:on-click="addOperator">
        <i-button type="primary">
            添加运算符
            <icon type="ios-arrow-down"></icon>
        </i-button>
        <dropdown-menu slot="list">
            <dropdown-item name="addition">加法</dropdown-item>
            <dropdown-item name="subtraction">减法</dropdown-item>
            <dropdown-item name="multiplication">乘法</dropdown-item>
            <dropdown-item name="division">除法</dropdown-item>
        </dropdown-menu>
    </dropdown>
    <divider></divider>
    <collapse>
        <panel v-for="(op, index) in generator.operators" :key="'op' + index">
            <span>{{ op.operatorName }}</span>
            <div slot="content" class="editor">
                <collapse simple>
                    <panel>
                        <span v-if="!op.range.isAdv">随机取值</span>
                        <span v-else>高级随机取值</span>
                        <div slot="content">
                            <i-button type="warning" @click="op.toggleRangeType()">
                                <span v-if="op.range.isAdv">切换到普通随机取值 (可能会丢失数据)</span>
                                <span v-else>切换到高级随机取值</span>
                            </i-button>
                            <divider></divider>
                            <div>
                                a {{ op.operatorSymbol }} b :<br>
                                <i-input v-model="op.range.minA" placeholder="数字/表达式" style="width: auto"></i-input>
                                <span> ≤ a ≤ </span>
                                <i-input v-model="op.range.maxA" placeholder="数字/表达式" style="width: auto"></i-input>
                                <br>
                                <i-input v-model="op.range.minB" placeholder="数字/表达式" style="width: auto"></i-input>
                                <span> ≤ b ≤ </span>
                                <i-input v-model="op.range.maxB" placeholder="数字/表达式" style="width: auto"></i-input>
                            </div>
                            优先计算:
                            <radio-group v-model="op.range.first" type="button">
                                <radio label="0">a</radio>
                                <radio label="1">b</radio>
                            </radio-group>
                        </div>
                    </panel>
                </collapse>
                <i-button type="primary" @click="op.addRule()" style="margin-top: 6px">
                    添加规则
                </i-button>
                <div v-for="(rule, index) in op.rules">
                    <i-input v-model="rule.condition" placeholder="布尔值表达式" style="width: 100%">
                        <i-button slot="append" @click="op.rules.removeIndex(index)" class="no-spacing"
                                  style="height: 32px" type="error" icon="md-close"></i-button>
                    </i-input>
                </div>
            </div>
        </panel>
    </collapse>
    <divider></divider>
    <i-button @click="generate" type="primary" icon="md-shuffle">生成算式</i-button>
    <i-button @click="save" icon="md-code">生成JSON</i-button>
    <i-button @click="showLoadModal" icon="md-exit">加载JSON</i-button>
    <divider></divider>
    <p class="mono">{{ generator }}</p>
</div>

<script src="expr-eval.min.js"></script>
<script src="dist/operators.min.js"></script>
<script src="dist/generation.min.js"></script>
<script src="dist/mathgen.min.js"></script>
</body>
</html>