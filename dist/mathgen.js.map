{"version":3,"sources":["../mathgen.js"],"names":["parser","Parser","Array","prototype","randElement","Math","floor","random","length","rand","min","max","randInt","randBool","chance","Expression","source","isNaN","expression","parse","isNumber","Number","variables","evaluate","RandRange","minA","maxA","minB","maxB","bFirst","a","undefined","b","value","RandRangeAdv","target","BFirst","result","Rule","condition","OperatorGen","operator","range","rules","operatorGenFuncA","operatorGenFuncB","i","generateFunc","generate","every","x","validate","Generator","minOperators","maxOperators","operatorGens","generators","count","results","len","push","first","second","vm","Vue"],"mappings":"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","file":"mathgen.js","sourcesContent":["let parser = new Parser();\r\n\r\nArray.prototype.randElement = function () {\r\n    return this[Math.floor(Math.random() * this.length)];\r\n};\r\n\r\nfunction rand(min, max) {\r\n    return Math.random() * (max - min) + min;\r\n}\r\n\r\nfunction randInt(min, max) {\r\n    return Math.floor(Math.random() * (max - min + 1)) + min;\r\n}\r\n\r\nfunction randBool(chance) {\r\n    return Math.random() < chance;\r\n}\r\n\r\nclass Expression {\r\n    constructor(source) {\r\n        if (isNaN(source)) {\r\n            this.expression = parser.parse(source);\r\n            this.isNumber = false;\r\n        }\r\n        else {\r\n            this.expression = Number(source);\r\n            this.isNumber = true;\r\n        }\r\n    }\r\n\r\n    value(variables = {}) {\r\n        return this.isNumber ? this.expression : this.expression.evaluate(variables);\r\n    }\r\n}\r\n\r\nclass RandRange {\r\n    constructor(minA, maxA, minB, maxB, bFirst = false) {\r\n        this.minA = new Expression(minA);\r\n        this.maxA = new Expression(maxA);\r\n        this.minB = new Expression(minB);\r\n        this.maxB = new Expression(maxB);\r\n        this.bFirst = bFirst;\r\n    }\r\n\r\n    generate(a = undefined, b = undefined) {\r\n        if (a !== undefined && b !== undefined) {\r\n            return [a, b];\r\n        }\r\n        else if (a === undefined && b === undefined) {\r\n            if (this.bFirst) {\r\n                b = randInt(this.minB.value(), this.maxB.value());\r\n            }\r\n            else {\r\n                a = randInt(this.minA.value(), this.maxA.value());\r\n            }\r\n        }\r\n        if (a !== undefined) {\r\n            b = randInt(this.minB.value({a: a}), this.maxB.value({a: a}));\r\n            return [a, b];\r\n        }\r\n        else if (b !== undefined) {\r\n            a = randInt(this.minA.value({b: b}), this.maxA.value({b: b}));\r\n        }\r\n        return [a, b];\r\n    }\r\n}\r\n\r\nclass RandRangeAdv extends RandRange {\r\n    constructor(minA, maxA, minB, maxB, expression, target, BFirst = false) {\r\n        super(minA, maxA, minB, maxB, BFirst);\r\n        this.expression = parser.parse(expression);\r\n        if (target === 'a') this.target = 0;\r\n        else if (target === 'b') this.target = 1;\r\n    }\r\n\r\n    generate(a = undefined, b = undefined) {\r\n        let result = super.generate(a, b);\r\n        if (!((a !== undefined && this.target === 0) || (b !== undefined && this.target === 1))) {\r\n            result[this.target] = this.expression.evaluate({a: result[0], b: result[1]});\r\n        }\r\n        return result;\r\n    }\r\n}\r\n\r\nclass Rule {\r\n    constructor(condition) {\r\n        this.condition = parser.parse(condition);\r\n    }\r\n\r\n    validate(variables = {}) {\r\n        return this.condition.evaluate(variables);\r\n    }\r\n}\r\n\r\nclass OperatorGen {\r\n    constructor(operator, range, ...rules) {\r\n        this.operator = operator;\r\n        this.range = range;\r\n        this.rules = rules;\r\n    }\r\n\r\n    generate(operatorGenFuncA = undefined, operatorGenFuncB = undefined) {\r\n        let a = 0, b = 0;\r\n        let i = 0;\r\n        let variables;\r\n        let generateFunc = () => [a, b] = this.range.generate();\r\n        if (operatorGenFuncA !== undefined && operatorGenFuncB !== undefined) {\r\n            generateFunc = () => {\r\n                a = operatorGenFuncA();\r\n                b = operatorGenFuncB();\r\n            }\r\n        }\r\n        else if (operatorGenFuncA !== undefined) {\r\n            generateFunc = () => {\r\n                a = operatorGenFuncA();\r\n                [a, b] = this.range.generate(a);\r\n            }\r\n        }\r\n        else if (operatorGenFuncB !== undefined) {\r\n            generateFunc = () => {\r\n                b = operatorGenFuncB();\r\n                [a, b] = this.range.generate(b);\r\n            }\r\n        }\r\n        do {\r\n            generateFunc();\r\n            variables = {a: a.evaluate(), b: b.evaluate()};\r\n            i++;\r\n        }\r\n        while (!this.rules.every(x => x.validate(variables)) && i <= 10000);\r\n        if (i >= 10000) {\r\n            return undefined;\r\n        }\r\n        return new this.operator(a, b);\r\n    }\r\n}\r\n\r\nclass Generator {\r\n    constructor(minOperators, maxOperators, ...operatorGens) {\r\n        this.min = minOperators;\r\n        this.max = maxOperators;\r\n        this.generators = operatorGens;\r\n    }\r\n\r\n    generate(count = 1) {\r\n        let results = [];\r\n        for (let i = 0; i < count; i++) {\r\n            let len = randInt(this.min, this.max);\r\n            if (len === 1) {\r\n                results.push(this.generators.randElement().generate());\r\n            }\r\n            else if (len === 2) {\r\n                let first = this.generators.randElement();\r\n                let second = this.generators.randElement();\r\n                if (randBool(0.5)) {\r\n                    results.push(first.generate(() => second.generate()));\r\n                }\r\n                else {\r\n                    results.push(first.generate(undefined, () => second.generate()));\r\n                }\r\n            }\r\n        }\r\n        return results;\r\n    }\r\n}\r\n\r\nlet vm = new Vue({\r\n    // 选项\r\n});"]}